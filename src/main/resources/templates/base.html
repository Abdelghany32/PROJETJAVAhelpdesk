<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<div th:fragment="head">
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Bootstrap 5 -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<!-- Font Awesome pour les icônes -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<!-- Google Fonts - Roboto -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
	<!-- Notre CSS personnalisé -->
	<link th:href="@{/css/style.css}" rel="stylesheet" type="text/css">
	<!-- Scripts -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
			crossorigin="anonymous"></script>
	<!-- Dans votre head, remplacez par : -->
	<script>
		document.addEventListener('DOMContentLoaded', function() {
    const themeToggle = document.getElementById('theme-toggle');

    function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        console.log('Thème changé en:', theme); // Pour le débogage
    }

    function toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        applyTheme(newTheme);
    }

    // Initialisation
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (savedTheme) {
        applyTheme(savedTheme);
    } else if (prefersDark) {
        applyTheme('dark');
    }

    // Écouteur d'événement
    if (themeToggle) {
        themeToggle.addEventListener('click', toggleTheme);
        console.log('Bouton trouvé et écouteur ajouté'); // Pour le débogage
    } else {
        console.error('Bouton theme-toggle non trouvé');
    }
});
	</script>
</div>

<style>
	/* Style pour le bouton theme toggle */
    #theme-toggle {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.3s ease;
        margin-right: 10px;
    }

    #theme-toggle:hover {
        transform: scale(1.1);
    }

    /* Gestion des icônes selon le thème */
    [data-theme="dark"] #theme-toggle .fa-moon {
        display: none;
    }

    [data-theme="dark"] #theme-toggle .fa-sun {
        display: inline-block;
        color: #FFD700; /* Couleur or pour le soleil */
    }

    [data-theme="light"] #theme-toggle .fa-sun {
        display: none;
    }

    [data-theme="light"] #theme-toggle .fa-moon {
        display: inline-block;
        color: #2c3e50; /* Couleur sombre pour la lune */
    }
</style>

<div th:fragment="logo-al" class="logo-container mb-3 p-3 d-flex justify-content-between align-items-center">
	<span class="logo"><a href="/student/dashboard">Resolve Aqui</a></span>
	<div class="d-flex align-items-center">
		<!-- Bouton dark/light mode ajouté ici -->
		<button id="theme-toggle" class="btn btn-outline-light">
			<i class="fas fa-moon"></i>
			<i class="fas fa-sun" style="display: none;"></i>
		</button>

		<div class="dropdown me-3">
			<button class="btn btn-outline-light dropdown-toggle" type="button" id="userMenuDropdown" data-bs-toggle="dropdown" aria-expanded="false">
				<i class="fas fa-user me-2"></i><span sec:authentication="name">Utilisateur</span>
			</button>
			<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuDropdown">
				<li><a class="dropdown-item" href="/student/profile"><i class="fas fa-id-card me-2"></i>Mon profil</a></li>
				<li><a class="dropdown-item" href="/student/settings"><i class="fas fa-cog me-2"></i>Paramètres</a></li>
				<li><hr class="dropdown-divider"></li>
				<li>
					<form id="form-logout-al" th:action="@{/logout}" method="post">
						<button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt me-2"></i>Déconnexion</button>
					</form>
				</li>
			</ul>
		</div>
	</div>
</div>

<div th:fragment="logo-ag" class="logo-container mb-3 p-3 d-flex justify-content-between align-items-center">
	<span class="logo"><a href="/agent/dashboard">Resolve Aqui</a></span>
	<div class="d-flex align-items-center">
		<!-- Bouton dark/light mode ajouté ici -->
		<button id="theme-toggle" class="btn btn-outline-light" aria-label="Toggle theme">
			<i class="fas fa-moon"></i>
			<i class="fas fa-sun" style="display: none;"></i>
		</button>

		<div class="dropdown me-3">
			<button class="btn btn-outline-light dropdown-toggle" type="button" id="userMenuDropdown" data-bs-toggle="dropdown" aria-expanded="false">
				<i class="fas fa-user me-2"></i><span sec:authentication="name">Utilisateur</span>
			</button>
			<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuDropdown">
				<li><a class="dropdown-item" href="/agent/profile"><i class="fas fa-id-card me-2"></i>Mon profil</a></li>
				<li><a class="dropdown-item" href="/agent/settings"><i class="fas fa-cog me-2"></i>Paramètres</a></li>
				<li><hr class="dropdown-divider"></li>
				<li>
					<form id="form-logout-ag" th:action="@{/logout}" method="post">
						<button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt me-2"></i>Déconnexion</button>
					</form>
				</li>
			</ul>
		</div>
	</div>
</div>

<div th:fragment="logo-no-logout" class="logo-container mb-3 p-3 d-flex justify-content-between align-items-center">
	<span class="logo">Resolve Aqui</span>
	<div>
		<a href="/student/login" class="btn btn-outline-light me-2"><i class="fas fa-user me-1"></i> Étudiant</a>
		<a href="/agent/login" class="btn btn-outline-light"><i class="fas fa-headset me-1"></i> Agent</a>
	</div>
</div>